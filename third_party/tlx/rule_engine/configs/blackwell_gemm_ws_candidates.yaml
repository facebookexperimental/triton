version: 1

inputs: [M, N, K, num_sms]

hardware:
  MAX_SMEM: 237568   # 232 * 1024
  MAX_TMEM: 262144   # 256 * 1024

configs:
  # Best config for tall-M shapes (3159809, 384, 384)
  - {BLOCK_SIZE_M: 256, BLOCK_SIZE_N: 128, BLOCK_SIZE_K: 128,
     NUM_CTAS: 2, NUM_SMEM_BUFFERS: 2, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 1}
  # Best config for large square matrices (8192x8192x8192)
  - {BLOCK_SIZE_M: 256, BLOCK_SIZE_N: 256, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 3, NUM_TMEM_BUFFERS: 1,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 4}
  # Best config for large-K shapes (1024, 256, 16384) - needs Split-K
  - {BLOCK_SIZE_M: 128, BLOCK_SIZE_N: 64, BLOCK_SIZE_K: 128,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 4, NUM_TMEM_BUFFERS: 3,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 1}
  # 2-CTA configs with BLOCK_K=128 (best performing from autotuning)
  - {BLOCK_SIZE_M: 256, BLOCK_SIZE_N: 128, BLOCK_SIZE_K: 64,
     NUM_CTAS: 2, NUM_SMEM_BUFFERS: 5, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 4}
  - {BLOCK_SIZE_M: 128, BLOCK_SIZE_N: 256, BLOCK_SIZE_K: 64,
     NUM_CTAS: 2, NUM_SMEM_BUFFERS: 4, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 1, EPILOGUE_SUBTILE: 2}
  - {BLOCK_SIZE_M: 256, BLOCK_SIZE_N: 64, BLOCK_SIZE_K: 128,
     NUM_CTAS: 2, NUM_SMEM_BUFFERS: 5, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 4}
  - {BLOCK_SIZE_M: 128, BLOCK_SIZE_N: 64, BLOCK_SIZE_K: 128,
     NUM_CTAS: 2, NUM_SMEM_BUFFERS: 5, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 1}
  # 1-CTA configs
  - {BLOCK_SIZE_M: 256, BLOCK_SIZE_N: 64, BLOCK_SIZE_K: 128,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 5, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 8}
  - {BLOCK_SIZE_M: 128, BLOCK_SIZE_N: 256, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 3, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 1, EPILOGUE_SUBTILE: 2}
  - {BLOCK_SIZE_M: 128, BLOCK_SIZE_N: 128, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 4, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 1, EPILOGUE_SUBTILE: 2}
  - {BLOCK_SIZE_M: 256, BLOCK_SIZE_N: 128, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 3, NUM_TMEM_BUFFERS: 1,
     NUM_MMA_GROUPS: 2, EPILOGUE_SUBTILE: 2}
  - {BLOCK_SIZE_M: 128, BLOCK_SIZE_N: 64, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 5, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 1, EPILOGUE_SUBTILE: 1}
  - {BLOCK_SIZE_M: 64, BLOCK_SIZE_N: 128, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 5, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 1, EPILOGUE_SUBTILE: 1}
  - {BLOCK_SIZE_M: 64, BLOCK_SIZE_N: 64, BLOCK_SIZE_K: 64,
     NUM_CTAS: 1, NUM_SMEM_BUFFERS: 6, NUM_TMEM_BUFFERS: 2,
     NUM_MMA_GROUPS: 1, EPILOGUE_SUBTILE: 1}

scoring: wave_efficiency
